Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.4
Creation-Date: 2017-01-13T11:47:12+00:00

====== Friday 13 Jan 2017 ======

Progress is painfully slow, but I'm finally at the position where I can start thinking about getting all my events to flow through Backbone - effecting the display of calendar stuff and handling clicks as they occur.

I took a decision a while back that I won't yet handle individual calendar events as backbone models and collections.  Fullcalendar will continue to request them direct from the server and then display them.

I will however have a view/controller for the whole calendar, which will be linked to a collection of concerns.  Concerns are an internal concept used by Scheduler and correspond to the coloured boxes down the left hand side of the screen.  Each coloured box is one concern, one eventSource from FC's point of view, and one collection of events.  A given event in the back end might end up being displayed twice at the front end, because it is relevant to two different concerns.

Each concern references one element in the database - staff, pupil, room, property, service, or group.  The back end does all the hard work of selecting the events which involve that element, and then feeds down the required events to FC.  FC displays them.

So - what are my Backbone data structures.

Model - Concern
Collection - Concerns
View for each individual concern - to handle the left hand column
View for the whole calendar.

Can one do that?

Just noticed something interesting - although my public calendar events are displaying in my new front end, they're appearing in green rather than the pale blue provided by the old front end.  I'm fairly certain that the change to blue was effected purely at the server end - yes, it's held in the database as a preferred colour.  I also have a vague recollection that FC defaults to green?  No, it doesn't.  It defaults to blue.  Something then is causing my events to appear in green.  I wonder what.  I must investigate, but it's not urgent.  Interesting - the colour is definitely coming from the server, and yet when I run the old front end the server gives the colour as blue - when I run the new one it gives the colour as green.

Looking at the code, I can't see at all why it comes out blue on the main code branch.  Stop worrying about it for now.
