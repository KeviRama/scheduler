Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.4
Creation-Date: 2017-02-23T14:45:44+00:00

====== Thursday 23 Feb 2017 ======

New decision process for whether the user gets a left-hand column.

'''
If logged in and known user
  yes
elsif multiple public calendars
  yes
else
  no
end
'''


For the case of multiple public calendars, there will be no "Add" box and no xs to allow deletion - just like a pupil, but with a different initial selection.  Could do with some sort of can_pick_and_choose method (which controls presence of the Add box and the Xs column) and then a method of calculating the default set of concerns for those who can't pick and choose.

Note that people who aren't logged in will have no concerns - they have nowhere to store them.  People who are logged in but unknown could have their own real concerns.  They would be unable to delete them, but they could at least get the same set of on/off states the next time they visit.  Genuinely not-logged-in-at-all people will need some sort of pseudo-concern, since we specify groups of events to fetch via a concern-id.  Perhaps create a dummy user to own them.  Never update the visibility flags for this user back to the d/b.  How then does the not-logged-in-user save his choices?  Interesting.

Perhaps send down some kind of dummy concern id instead of a real one - something which can never be a real concern ID.  Not a simple number.  Then when we get it back we know it's a dummy, and we can store the flag info in the non-user's session.
