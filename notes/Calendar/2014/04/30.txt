Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.4
Creation-Date: 2014-04-30T14:01:31+01:00

====== Wednesday 30 Apr 2014 ======

Andy has given me the IP details for Mach2, so I'll set it up now and take it into school tomorrow.  I need to get some of the setup from Guardian's backup of Knight.

It should be:

IP address: 172.16.1.21
Netmask: 255.255.248.0
Network: 172.16.0.0
Broadcast: 172.16.7.255
Gateway: 172.16.0.1
dns-search scheduler.org.uk abingdon.org.uk
dns-nameservers 172.16.0.4


What needs setting up on Mach2?

'''
/etc/network/interfaces
/etc/resolv.conf			Make sure resolvconf is installed.
/etc/apt/sources.list
/etc/apt/apt.conf.d/<file to use a proxy>
'''

Remove any left over NTP configuration received via DHCP. /var/lib/ntp/ntp.conf.dhcp

And packages?

Software to access the server:

tdsodbc
UnixODBC

And I will need to install Squid on Hydra, instead of Apache2.  Nothing sensible uses Apache2 at present.


Just hit an interesting problem when I tried to do a "bundle install" on Mach2.  It wouldn't connect to rubygems.org because it couldn't verify its SSL certificates.  This suggests I need to get new certificates, but the documentation is confused.  It's possible I generated my copy of Ruby (it was compiled by RVM) without ssl support.  I have some notes in my DevelopmentEnvironment Zim file about what needs to pre-exist before you build Ruby.  Hmmm.  libssl-dev does seem to be installed.  A certificates issue then.

Just to check my ruby, I fired up irb and typed "require 'openssl'", which seemed to work.  It therefore must be certificates.

In theory, rvm can resolve the problem, but when I try to run rvm it gives an error message:

-bash: security: command not found

It's not just an RVM problem - curl too refuses to fetch from the indicated source.  Found out why - the clock on Mach2 is hopelessly wrong.  Why?  It was right earlier - when I did the install.  It seems to have lost the time several re-boots back.  NTP is running, but doesn't seem to be getting the time right.  If I query it, it says it hasn't yet got the right time.  Why not?

The date and time stayed fine over several re-boots on the day I set it up, then suddenly reset to Jan 1.  This happened over a re-boot - when the machine went down it had the right date and time, and then when it came back it didn't.  Odd.  Battery issues?  It has good connectivity to the outside world, and yet seems to fail to pick up the time.  Ah - it isn't using [[/etc/ntp.conf]] - it's using something which it got via dhcp.  And yes, it's trying to use matrix as its NTP server. So:

* Fix my DHCP server to advertise the right NTP server
* Get time right on Mach2
* Make sure it can store the time.

Just trying for a reboot on Mach2, having set the time using ntp, then saved it using hwclock.  It may be that its battery is knackered.

Finally straightened that out and got the app properly installed on Mach 2.  Now to clean it up to go to school.  Steps required are above.  Done.

Now let's remove Apache2 from Hydra and replace it with Squid, configured as for Squid on Server.  Squid3 seems to be the package which I am using on Server.  Installed, and tentatively configured.  I need to wait for DNS to propagate before I can test it at all.  I need to get Mach2 installed before I can test it fully.

How about some code.  Can I use a date picker in my Eras dialogue instead of the current cludgy way?  I am already achieving this in Xronos, but using formtastic.  Can I do it without.

Change the date_select field in my form to a text_field, and give it an id of datepicker.  Ah, that's interesting.  If I want two datepicker fields in the same form, they can't both have an id of datepicker.  Also, Rails tends to use ids too, and mine has displaced theirs.  Can I do it by way of a class?  I can certainly specify a class, now can I arrange for it to become a datepicker?
