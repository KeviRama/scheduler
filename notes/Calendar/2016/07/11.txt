Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.4
Creation-Date: 2016-07-11T11:58:08+01:00

====== Monday 11 Jul 2016 ======

Progressing with the iSAMS => Scheduler feed.  Want to look at gaps and suspensions.  I haven't noticed these at all in the data which I'm getting from iSAMS, so I may just need to implement them from the d/b for now.

Taken a look at the Batch API methods - there don't seem to be any to do with lesson suspensions.  Indeed, I don't even know whether iSAMS has this concept.  Fortunately, Scheduler does so we can use that.

I store them both as something which I call a Hiatus.  A hiatus is soft if the lessons still appear (Suspension) or hard if it wipes them out entirely (Gap).  You use a Suspension (soft hiatus) when you want information about what lessons would have been still to appear, and Gap (hard hiatus) to wipe them out entirely.

For instance, if you have a 4th year activity day, then you want to suspend their lessons but it's useful to know who would otherwise have been teaching them.

If you have an INSET day, then you don't want lessons to appear at all.

An interesting problem in the are of handling groups in my main Scheduler code.

Groups have a start date, and end date, and a current flag.  These need care to ensure they are consistent, and I need to make sure the current flag gets removed in a timely fashion.

The thing is, my current year's tutor groups all have an end date of 31/8/16, and all currently have current = true.  AFAICS, there is no code to set them all to false on the 1st of September.  The current ceases_existence method won't do it because if called on the 1st of September, it will fail the active_on() check and do nothing.  It needs the end date not to have been set already.

Need to think about that one.  Some kind of end-of-year processing is needed.  I'm surprised it's not already there.  Probably need the same for teaching groups too.  Or I could enhance the existing ceases_existence method to take care of it.

We don't want to affect the current flag if we're being told about an end of existence in the future, but we do if it's today, or in the past.
