Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.4
Creation-Date: 2016-08-24T10:09:02+01:00

====== Wednesday 24 Aug 2016 ======

In school, seeing about upgrading our scheduler installation onto the VPS.

Currently the VPS is running the 2.1.1 version of Scheduler, so it needs quite a bit of upgrading.  Happily, it shouldn't matter if I take it down for a while.

So - first need to upgrade to the latest version of Scheduler.  Start by stopping nginx.

I've reached the really annoying position where the VPS can't fetch data in the way my machine at home does.  There is something different in the configuration and I need to work out exactly what it is.  Trouble is, the documentation in this area is very poor.  It's not even clear which configuration files are used by what.

The error which I get when I run my utility is "Server name not found in configuration files".  The server name which I appear to be trying to use is "isams".  That does seem to be named in my freetds.conf file.

Seem to have got around it by putting the host and port number expressly in the d/b.

Just noticed that the time is wrong on the VPS.  Need to fix that.  Set timezone to London and re-booted.

Although I fixed the time zone for this server and then re-booted, we seem to be getting everything adjusted by an hour.  This may be because I loaded the d/b tables before I adjusted the time zone?  Or because I fetched the data before?

And I seem to have broken nginx too.  Yuk.

Right.  With the clock correct I have re-loaded the d/b and re-fetched the data from iSAMS.  Let's see if it still ends up changing lots of times of things.  If that's OK, then I can move on to working out what's wrong with nginx.

The error from nginx seems to be:

No such file or directory - [[/home/scheduler/.rvm/gems/ruby-2.1.1@scheduler/gems/passenger-5.0.29/src/helper-scripts/rack-preloader.rb]]

It may be that I broke this a while ago.  I was fiddling around with getting newer versions of Passenger, and I may have accidentally removed the old one, or removed it from my installation.  In any case, it's fragile to rely on one from an old and now defunct rubygem.

Do seem - I hope - to have fixed the off-by-an-hour problem.

Looking at that long path specification above, I'm fine up to the passenger-5.0.29 bit, but the src directory isn't there, which is odd.  Go into that gemset and explicitly re-install passenger 5.0.29.  Now it's there again.  Will nginx work?  It seems to.  Not sure how I managed to partially uninstall that gem.  Probably needs tidying up at some point.

All now seems to be working.  Jobs still to do for Niki:

[*] Get him logged in to the VPS
[*] Set up a cron job on the VPS to update things
[ ] Set up Google login for VPS
[*] Dump database on mach2


