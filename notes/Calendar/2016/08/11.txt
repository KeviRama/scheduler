Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.4
Creation-Date: 2016-08-11T10:42:48+01:00

====== Thursday 11 Aug 2016 ======

Two possible things to do today:

[*] Add a small facility to the utility to check that iSAMS IDs do in fact match SB IDs, at least for values up to 16052.
[*] Make conversion controlled by a switch - --convert

Both of these are relatively standalone features.

Done the first one and run it against data.1.xml - my first extraction.  The only pupil who does not have the same isams ID and SB id is pupil 437, Freddie Ward.  Clearly he is the first one for whom Niki changed the ID.  It should therefore be reasonably safe for me to use the iSAMS ID as if it were the SB ID in order to do the conversion.  I should perhaps put in a check to do it only for pupils with an ID less than 16052, but that may not be necessary.  I can change the field names to reflect the new meaning.

Now attempting a fresh conversion from scratch.  Run it with the --convert option, it took 52m20s.  Any surprises in the output file?  Lot of output, but nothing too surprising.  Now run it again without the --convert option to check for idempotence.  Took 12m33s.  A small number of changes to the suspended nature of lessons.

'''
Suspension state for 4S Ph1b at 2016-09-06 11:10:00 +0100 changed from true to false.
Suspension state for 4S EnD2 at 2016-09-06 11:10:00 +0100 changed from true to false.
Suspension state for 4S EnB3 at 2016-09-06 11:10:00 +0100 changed from true to false.
Suspension state for 4S EnD1 at 2016-09-06 11:10:00 +0100 changed from true to false.
Suspension state for 4S EnA1 at 2016-09-06 11:10:00 +0100 changed from true to false.
Suspension state for 4S Ph3b at 2016-09-06 11:10:00 +0100 changed from true to false.
Suspension state for 4S EnB1 at 2016-09-06 11:10:00 +0100 changed from true to false.
Suspension state for 4S EnB2 at 2016-09-06 11:10:00 +0100 changed from true to false.
Suspension state for 1S Hi at 2016-09-06 11:10:00 +0100 changed from false to true.
Suspension state for 1P Ma at 2016-09-06 11:10:00 +0100 changed from false to true.
Suspension state for 4S EnA2 at 2016-09-06 11:10:00 +0100 changed from true to false.
Suspension state for 1M Ma at 2016-09-06 11:10:00 +0100 changed from false to true.
'''


Those all seem to be correct.  4th year lessons should not be suspended then, and 1st year should be.  Presumably we used to have 3rd years in the 4th year sets, and no pupils in the 1st year sets.  Excellent.  A third run I think to be sure things have stabilised.  Final run took 12m33s and doesn't seem to have changed anything.

We have a couple of redundant house entries in iSAMS.  Could I discard them at input on the grounds that they don't have valid housemasters?

Which groups are era based and which are perpetual?

Tutorgroup			Year based.
Teachinggroup		Year based.
Otherhalfgroup		Year based.
Taggroup				Perpetual.

I was thinking about setting up the new VPS to test the conversion process and automated updates.  I won't be able to do that until Niki comes back from holiday though, because I need a new IP address adding to our whitelist for accessing the database, and he'll need to request that.  I'll do it on my staging server instead.
