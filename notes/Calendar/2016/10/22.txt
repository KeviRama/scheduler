Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.4
Creation-Date: 2016-10-22T11:39:18+01:00

====== Saturday 22 Oct 2016 ======

I propose to do a little test today.  I will take the latest data files from iSAMS, and process them on my test system to produce output files for Markbook.  Then a copy of the latest d/b dump from PseudoNimbus, load it on my development wheezy VM on knight, and test that the files import correctly.  The object of the exercise is to test two different things:

* That the files produced by my modified utility still suit Markbook.
* That I can run a Markbook development environment usefully in this VM.

Once I am confident of the latter, I can think about upgrading Midnight to Jessie.

There seem to be a lot of new staff created in the latest download.  Check that out.  There are 31, including Valerie Findlay, so perhaps they've just added in the peris.

[*] Data files from VPS to Knight
[*] Load data files
[*] Dump d/b on PN
[*] Copy to local VM
[*] Load on local VM
[*] Check version of s/w on local VM
[*] Test Markbook running on VM.
[*] Get data files just generated on Knight onto VM.
[*] Do data load on local VM for Markbook

Interesting - everything seems to have worked pretty much as expected except in the data load on my Markbook system, all the pupils in 4/MIL/MTJ have been moved to 4/MIL/KEMW.  The trouble is, both my live and test scheduler systems still think they should be in 4/MIL/MTJ.

A sample is Oliver Chester.  Check him in the various data files.  I have the latest files from iSAMS already on Knight (see first ticked step above).  He is clearly listed in the iSAMS file as being in 4/MIL/MTJ, and his tutor is listed as being "MTJ1875...", which also seems right.  I must be getting a crossed thread somewhere.  Check the entry for the actual tutor group.

The Markbook loader refers to 4/MIL/MTJ as having id 251 and 4/MIL/KEMW as having id 252.  Where was this ID generated?  It doesn't seem to come from iSAMS.  Do I have some sort of old file by any chance?  It seems that the KEMW tutor group did exist right at the start of the term, and these boys were in it up until the 9th of September.  Then they were transferred to 4/MIL/MTJ on the 10th.  This does sound very much like I've got an old file somewhere.

The tutorgroups.yml file which I now have on the Markbook VM definitely has KEMW and not MTJ leading the tutor group.  But the one in the source directory on Knight has MTJ.  Huh?  What?  What command did I use to copy over?  Looking at my bash_history it seems correct.

'''
cd import/data/
ls
cd 2016/
ls
ls -l
cat fetch
scp knight:Work/Coding/scheduler/import/ForMarkbook/*.yml .
ls -l
'''


Where did I go wrong?  Step away from the keyboard for a minute or two - I am missing something stunningly obvious.

As indeed I was.  I forgot that my scripts are slightly convoluted.  The markbook loading script expects to copy its files from elsewhere on the same machine before it loads them.  I had copied them to the target location of this copy instead of to the source - hence the problem.

Now need to load the d/b again and do the import properly.  Seems to have worked fine, except that Anne Whitehead's initials have been re-used for someone new called Andy Wraight.  I'll need to change her initials in Markbook so that he gets his own new record instead of appropriating hers.

Seems fine.  Enough for today.
