Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.4
Creation-Date: 2015-07-31T16:15:31+01:00

====== Friday 31 Jul 2015 ======

Been thinking about implementation details, and decided I got things slightly wrong.

Calendar as a property is right - all sorts of different kinds of events can go in the calendar.

My idea of "Key dates" as a property is however wrong.  By "key dates" I mean dates which should appear in everybody's calendars.  This is different from what DJD means - see his list.  I think I should leave the term "key date" for DJD, and they too can be implemented as a property.  What he does with them after that is up to him.

The functionality which I want - that of breaking through onto everyone's calendar - should remain as a flag to be applied to event categories.  Certain specific categories of event should break through.  Obvious examples are "Week letter" and "Term date".  These categories should also be flagged as being privileged, and should be available only to certain privileged editors.  Others just won't see them in their lists.

For historic reasons, the property of breaking through on all calendars is called "for_users" - not sure what my thinking was there.  There is another flag called "schoolwide", but I'm not sure to what extent that is used.  What event categories currently have these set?

schoolwide is set for "Key date (external)", "Key date (internal)" and "Week letter"

for_users is set for the same three, plus "Gap (visible)"

Does any code actually implement the functionality of "schoolwide"?  I've a feeling I may only check the "for_users" flag.  The "schoolwide" one is more logically named.  I've searched and as far as I can see, you can edit the schoolwide flag but it has no effect.  I think that one should take over providing the relevant functionality, but any eventcategory with that flag set should require special privilege before you can use it.

I have removed the schoolwide/for_users functionality from the schedule display code - I need to put it back.  I will rename my "Key date" categories and make them "Term date" instead.

The Gap functionality (making lessons non-existent) should also go in as a property.

My conversion code is in need of a mark 2 version.  It will need to mess about with some event categories too.

Ah - found the difference between schoolwide and for_users.  schoolwide is intended to appear on *all* calendars, logged in or not, whilst for_users is intended for all logged in users.  What I have historically shown non logged in users is the Calendar, and given that the Calendar is now defined by a property and not by what event category things are in, I think this distinction stops being meaningful.

Users who aren't logged in see the calendar - we're used to that and it makes a lot of sense.  We could potentially add another property at a later date if we wanted to cause more stuff (which isn't wanted in the calendar) to appear, but what's displayed at this point is definitely not controlled by event category, or by any flags on the event categories.

That then frees up "schoolwide" to mean things which are to be shown to all //logged in// users.  For now this will be the following event categories

Term date
Week letter

More can be added to this later if required.  What can I do to existing event categories then?  I have a list.
